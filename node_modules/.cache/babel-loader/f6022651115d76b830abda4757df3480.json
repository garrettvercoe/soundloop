{"ast":null,"code":"import _slicedToArray from \"/Users/ericduong/Documents/repos/soundloop/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _objectSpread from \"/Users/ericduong/Documents/repos/soundloop/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nvar _jsxFileName = \"/Users/ericduong/Documents/repos/soundloop/src/components/Loop.js\";\nimport React, { Component } from \"react\";\nimport { render } from \"react-dom\";\nimport { Layer, Transformer, Circle } from \"react-konva\";\nimport { connect } from \"react-redux\";\nimport { addLoop, updateLoop } from \"../actions/loops\";\n\nfunction LoopScale({\n  shapeProps,\n  isSelected,\n  onSelect,\n  onChange\n}) {\n  // shape state reference\n  const shapeRef = React.useRef(); // transformer state reference\n\n  const trRef = React.useRef();\n  React.useEffect(() => {\n    if (isSelected) {\n      // we need to attach transformer manually\n      trRef.current.setNode(shapeRef.current);\n      trRef.current.getLayer().batchDraw();\n    }\n  }, [isSelected]); // return circle and transformer when selected\n\n  return React.createElement(React.Fragment, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 23\n    },\n    __self: this\n  }, React.createElement(Circle, Object.assign({\n    onClick: onSelect,\n    ref: shapeRef\n  }, shapeProps, {\n    x: window.innerWidth / 2,\n    y: window.innerHeight / 2,\n    fill: \"transparent\",\n    stroke: \"#ed1e79\",\n    strokeWidth: 1.5 // onTransformEnd: change properties based on scale and reset scale of shapeProps\n    ,\n    onTransformEnd: e => {\n      // transformer is changing scale\n      const node = shapeRef.current;\n      const scaleX = node.scaleX(); // reset the scale of the node back to 1\n\n      node.scaleX(1);\n      node.scaleY(1);\n      onChange(_objectSpread({}, shapeProps, {\n        x: node.x(),\n        y: node.y(),\n        radius: node.radius() * scaleX\n      }));\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 25\n    },\n    __self: this\n  })), isSelected && React.createElement(Transformer, {\n    ref: trRef,\n    enabledAnchors: [\"top-right\", \"bottom-left\"],\n    centeredScaling: true,\n    rotateEnabled: false,\n    borderStrokeWidth: 0,\n    anchorFill: \"#ed1e79\",\n    anchorCornerRadius: 80,\n    anchorSize: 20,\n    anchorStrokeWidth: 0,\n    ignoreStroke: true,\n    boundBoxFunc: function (oldBoundBox, newBoundBox) {\n      if (Math.abs(newBoundBox.width) > Math.min(window.innerHeight * (4 / 5), window.innerWidth * (4 / 5))) {\n        return oldBoundBox;\n      } else if (Math.abs(newBoundBox.width) < Math.min(window.innerHeight / 5, window.innerWidth / 5)) {\n        return oldBoundBox;\n      }\n\n      return newBoundBox;\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 53\n    },\n    __self: this\n  }));\n}\n\n;\n\nclass LoopTest extends React.Component {\n  componentDidMount() {\n    console.log(\"Mounted\"); //this.props.dispatch(updateLoop())\n\n    this.props.dispatch(addLoop(1));\n  }\n\n  render() {\n    return React.createElement(Layer, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 96\n      },\n      __self: this\n    }, React.createElement(LoopScale, {\n      shapeProps: this.props.circle,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97\n      },\n      __self: this\n    }));\n  }\n\n}\n\nfunction Loop() {\n  // need to change to singular\n  const initialCircles = [{\n    radius: Math.min(window.innerWidth * (1 / 3), window.innerHeight * (1 / 3)),\n    id: \"loop\"\n  }];\n  const circleTest = {\n    width: window.innerWidth * (2 / 3),\n    height: window.innerHeight * (2 / 3),\n    id: \"loop\"\n  };\n\n  const _React$useState = React.useState(initialCircles),\n        _React$useState2 = _slicedToArray(_React$useState, 2),\n        circles = _React$useState2[0],\n        setCircles = _React$useState2[1];\n\n  const _React$useState3 = React.useState(null),\n        _React$useState4 = _slicedToArray(_React$useState3, 2),\n        selectedId = _React$useState4[0],\n        selectShape = _React$useState4[1];\n\n  const _React$useState5 = React.useState(circleTest),\n        _React$useState6 = _slicedToArray(_React$useState5, 2),\n        circle = _React$useState6[0],\n        setCircle = _React$useState6[1];\n\n  return React.createElement(Layer, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122\n    },\n    __self: this\n  }, React.createElement(LoopScale, {\n    shapeProps: circle,\n    isSelected: circle.id === selectedId,\n    onSelect: () => {\n      selectShape(circle.id);\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124\n    },\n    __self: this\n  }));\n}\n\n;\n\nfunction mapStateToProps(state) {\n  console.log(state);\n  return {\n    //pass through loopExport\n    radius: state.loops.radius\n  };\n} // temporary component to handle componentDidMount and test state\n\n\nclass LoopExport extends React.Component {\n  componentDidMount() {\n    console.log(\"Mounted\"); //this.props.dispatch(updateLoop())\n\n    this.props.dispatch(addLoop(1));\n  }\n\n  render() {\n    return React.createElement(Loop, {\n      radius: this.props.radius,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 156\n      },\n      __self: this\n    });\n  }\n\n}\n\nexport default connect(mapStateToProps)(LoopExport); //export default connect(mapStateToProps)(LoopTest)","map":{"version":3,"sources":["/Users/ericduong/Documents/repos/soundloop/src/components/Loop.js"],"names":["React","Component","render","Layer","Transformer","Circle","connect","addLoop","updateLoop","LoopScale","shapeProps","isSelected","onSelect","onChange","shapeRef","useRef","trRef","useEffect","current","setNode","getLayer","batchDraw","window","innerWidth","innerHeight","e","node","scaleX","scaleY","x","y","radius","oldBoundBox","newBoundBox","Math","abs","width","min","LoopTest","componentDidMount","console","log","props","dispatch","circle","Loop","initialCircles","id","circleTest","height","useState","circles","setCircles","selectedId","selectShape","setCircle","mapStateToProps","state","loops","LoopExport"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport { render } from \"react-dom\";\nimport { Layer, Transformer, Circle } from \"react-konva\";\nimport { connect } from \"react-redux\";\nimport {addLoop, updateLoop} from \"../actions/loops\"\n\nfunction LoopScale ({ shapeProps, isSelected, onSelect, onChange }){\n\n  // shape state reference\n  const shapeRef = React.useRef();\n  // transformer state reference\n  const trRef = React.useRef();\n\n  React.useEffect(() => {\n    if (isSelected) {\n      // we need to attach transformer manually\n      trRef.current.setNode(shapeRef.current);\n      trRef.current.getLayer().batchDraw();\n    }\n  }, [isSelected]);\n  // return circle and transformer when selected\n  return (\n    <React.Fragment>\n      \n      <Circle\n        onClick={onSelect}\n        \n        ref={shapeRef}\n        {...shapeProps}\n        x={window.innerWidth/2}\n        y={window.innerHeight/2}\n        fill={\"transparent\"}\n        stroke={\"#ed1e79\"}\n        strokeWidth={1.5}\n        // onTransformEnd: change properties based on scale and reset scale of shapeProps\n        onTransformEnd={e => {\n          // transformer is changing scale\n          const node = shapeRef.current;\n          const scaleX = node.scaleX();\n\n          // reset the scale of the node back to 1\n          node.scaleX(1);\n          node.scaleY(1);\n          onChange({\n            ...shapeProps,\n            x: node.x(),\n            y: node.y(),\n            radius: node.radius() * scaleX,\n          });\n        }}\n      />\n      {isSelected && (\n        <Transformer\n          ref={trRef}\n          enabledAnchors={[\"top-right\", \"bottom-left\"]}\n          centeredScaling={true}\n          rotateEnabled={false}\n          borderStrokeWidth={0}\n          anchorFill={\"#ed1e79\"}\n          anchorCornerRadius={80}\n          anchorSize={20}\n          anchorStrokeWidth={0}\n          ignoreStroke={true}\n          boundBoxFunc={function(oldBoundBox, newBoundBox) {\n            if (\n              Math.abs(newBoundBox.width) >\n              Math.min(\n                window.innerHeight * (4 / 5),\n                window.innerWidth * (4 / 5)\n              )\n            ) {\n              return oldBoundBox;\n            } else if (\n              Math.abs(newBoundBox.width) <\n              Math.min(window.innerHeight / 5, window.innerWidth / 5)\n            ) {\n              return oldBoundBox;\n            }\n            return newBoundBox;\n          }}\n        />\n      )}\n    </React.Fragment>\n  );\n};\n\nclass LoopTest extends React.Component{\n  componentDidMount(){\n    console.log(\"Mounted\")\n    //this.props.dispatch(updateLoop())\n    this.props.dispatch(addLoop(1));\n  };\n\n  render(){\n    return(\n      <Layer>\n        <LoopScale shapeProps={this.props.circle}/>\n      </Layer>\n    )\n  }\n}\n\nfunction Loop(){\n  // need to change to singular\n  const initialCircles = [\n    {\n      radius: Math.min(window.innerWidth*(1/3), window.innerHeight*(1/3)),\n      id: \"loop\"\n    }\n  ];\n\n  const circleTest = {\n    width: window.innerWidth * (2 / 3),\n    height: window.innerHeight * (2 / 3),\n    id: \"loop\"\n  }\n\n  const [circles, setCircles] = React.useState(initialCircles);\n  const [selectedId, selectShape] = React.useState(null);\n  const [circle, setCircle] = React.useState(circleTest)\n  return (\n    <Layer>\n      \n          <LoopScale\n            \n            shapeProps={circle}\n            isSelected={circle.id === selectedId}\n            onSelect={() => {\n              selectShape(circle.id);\n            }}\n            \n          />\n        \n      \n    </Layer>\n  );\n};\n\nfunction mapStateToProps(state){\n  console.log(state)\n  return{\n    //pass through loopExport\n    radius: state.loops.radius\n  }\n}\n\n// temporary component to handle componentDidMount and test state\nclass LoopExport extends React.Component{\n  componentDidMount(){\n    console.log(\"Mounted\")\n    //this.props.dispatch(updateLoop())\n    this.props.dispatch(addLoop(1));\n  };\n  render(){\n    return(\n      <Loop radius={this.props.radius}/>\n    )\n  }\n}\n\nexport default connect(mapStateToProps)(LoopExport);\n//export default connect(mapStateToProps)(LoopTest)\n"]},"metadata":{},"sourceType":"module"}